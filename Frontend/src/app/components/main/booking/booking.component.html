<div class="booking-container">
  <!-- Enhanced Header Section -->
  <div class="booking-header">
    <div class="header-background">
      <div class="animated-gradient"></div>
      <div class="floating-elements">
        <div class="element element-1"></div>
        <div class="element element-2"></div>
        <div class="element element-3"></div>
      </div>
    </div>
    
    <div class="header-content">
      <div class="breadcrumb">
        <span class="breadcrumb-item">
          <i class="fas fa-search"></i>
          Search Results
        </span>
        <i class="fas fa-chevron-right breadcrumb-separator"></i>
        <span class="breadcrumb-item active">
          <i class="fas fa-ticket-alt"></i>
          Booking Details
        </span>
      </div>
      
      <h1 class="page-title">
        <span class="title-icon">
          <i class="fas fa-clipboard-check"></i>
        </span>
        <span class="title-text">Review Your Booking</span>
        <span class="title-subtitle">Complete your flight reservation</span>
      </h1>
    </div>
  </div>

  <div class="booking-content">
    <!-- Flight Review Section -->
    <div class="review-section">
      <div class="section-header">
        <h3 class="section-title">
          <i class="fas fa-plane"></i>
          Flight Details
        </h3>
        <div class="section-badge">
          <i class="fas fa-shield-check"></i>
          Confirmed
        </div>
      </div>

      <div class="flight-review-card">
        <div class="flight-header">
          <div class="airline-info">
            <div class="airline-logo">
              <i class="fas fa-plane"></i>
            </div>
            <div class="flight-number">
              <span class="flight-label">Flight</span>
              <span class="flight-code">{{ flightDetails?.flightNumber }}</span>
            </div>
          </div>
          <div class="flight-status">
            <span class="status-badge confirmed">
              <i class="fas fa-check-circle"></i>
              Available
            </span>
          </div>
        </div>

        <div class="flight-route">
          <div class="route-point departure">
            <div class="route-time">
              <span class="time">{{ flightDetails?.departureDateTime | date:'HH:mm' }}</span>
              <span class="date">{{ flightDetails?.departureDateTime | date:'dd MMM' }}</span>
            </div>
            <div class="route-location">
              <h4 class="city">{{ flightDetails?.origin }}</h4>
              <p class="airport">Departure</p>
            </div>
          </div>

          <div class="route-middle">
            <div class="flight-path">
              <div class="path-line">
                <div class="path-progress"></div>
              </div>
              <div class="plane-icon">
                <i class="fas fa-plane"></i>
              </div>
            </div>
            <div class="flight-duration">
              {{ calculateFlightDuration() }}
            </div>
          </div>

          <div class="route-point arrival">
            <div class="route-time">
              <span class="time">{{ flightDetails?.arrivalDateTime | date:'HH:mm' }}</span>
              <span class="date">{{ flightDetails?.arrivalDateTime | date:'dd MMM' }}</span>
            </div>
            <div class="route-location">
              <h4 class="city">{{ flightDetails?.destination }}</h4>
              <p class="airport">Arrival</p>
            </div>
          </div>
        </div>

        <div class="flight-details">
          <div class="detail-item">
            <i class="fas fa-dollar-sign"></i>
            <div class="detail-content">
              <span class="detail-label">Base Price</span>
              <span class="detail-value">${{ flightDetails?.economyPrice }}</span>
            </div>
          </div>
          <div class="detail-item">
            <i class="fas fa-utensils"></i>
            <div class="detail-content">
              <span class="detail-label">Meal</span>
              <span class="detail-value">Special No Meal Fare</span>
            </div>
          </div>
          <div class="detail-item">
            <i class="fas fa-chair"></i>
            <div class="detail-content">
              <span class="detail-label">Class</span>
              <span class="detail-value">Economy</span>
            </div>
          </div>
          <div class="detail-item">
            <i class="fas fa-suitcase"></i>
            <div class="detail-content">
              <span class="detail-label">Baggage</span>
              <span class="detail-value">15kg</span>
            </div>
          </div>
        </div>

        <div class="special-notice">
          <div class="notice-icon">
            <i class="fas fa-info-circle"></i>
          </div>
          <div class="notice-content">
            <h5 class="notice-title">Special Fare Notice</h5>
            <p class="notice-text">This is a special No Meal fare provided by the airline</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Grid -->
    <div class="content-grid">
      <!-- Traveller Details Section -->
      <div class="traveller-section">
        <div class="section-header">
          <h3 class="section-title">
            <i class="fas fa-users"></i>
            Traveller Details
          </h3>
          <div class="traveller-count">
            {{ travellerList.length }} 
            {{ travellerList.length === 1 ? 'Passenger' : 'Passengers' }}
          </div>
        </div>

        <!-- Information Notice -->
        <div class="info-notice">
          <div class="notice-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <p class="notice-text">
            Your booking details will be sent to this email address and mobile number.
          </p>
        </div>

        <!-- Traveller Form -->
        <div class="traveller-form-card">
          <div class="form-header">
            <h4 class="form-title">
              <i class="fas fa-user-plus"></i>
              Add Passenger
            </h4>
          </div>

          <form [formGroup]="travellerForm" class="traveller-form">
            <div class="form-grid">
              <div class="form-field">
                <label class="field-label">
                  <i class="fas fa-user"></i>
                  First Name
                </label>
                <input 
                  type="text" 
                  class="form-input" 
                  formControlName="firstName"
                  placeholder="Enter first name"
                  [class.error]="travellerForm.get('firstName')?.invalid && travellerForm.get('firstName')?.touched">
                <div class="field-error" *ngIf="travellerForm.get('firstName')?.invalid && travellerForm.get('firstName')?.touched">
                  <i class="fas fa-exclamation-circle"></i>
                  First name is required
                </div>
              </div>

              <div class="form-field">
                <label class="field-label">
                  <i class="fas fa-user"></i>
                  Last Name
                </label>
                <input 
                  type="text" 
                  class="form-input" 
                  formControlName="lastName"
                  placeholder="Enter last name"
                  [class.error]="travellerForm.get('lastName')?.invalid && travellerForm.get('lastName')?.touched">
                <div class="field-error" *ngIf="travellerForm.get('lastName')?.invalid && travellerForm.get('lastName')?.touched">
                  <i class="fas fa-exclamation-circle"></i>
                  Last name is required
                </div>
              </div>

              <div class="form-field">
                <label class="field-label">
                  <i class="fas fa-calendar-alt"></i>
                  Age
                </label>
                <input 
                  type="number" 
                  class="form-input" 
                  formControlName="age"
                  placeholder="Enter age"
                  min="1" max="120">
              </div>

              <div class="form-field">
                <label class="field-label">
                  <i class="fas fa-venus-mars"></i>
                  Gender
                </label>
                <select class="form-select" formControlName="gender">
                  <option value="">Select gender</option>
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                </select>
              </div>

              <div class="form-field">
                <label class="field-label">
                  <i class="fas fa-chair"></i>
                  Seat Class
                </label>
                <select class="form-select" formControlName="seatClass">
                  <option value="Economy">Economy Class</option>
                  <option value="Business">Business Class</option>
                </select>
              </div>
            </div>

            <div class="form-actions">
              <button 
                type="button" 
                class="add-btn" 
                *ngIf="!isEditing" 
                (click)="addTraveller()"
                [disabled]="travellerForm.invalid || isProcessing">
                <span class="btn-content" *ngIf="!isProcessing">
                  <i class="fas fa-plus"></i>
                  Add Passenger
                </span>
                <span class="btn-loading" *ngIf="isProcessing">
                  <div class="btn-spinner"></div>
                  Adding...
                </span>
              </button>
            </div>
          </form>
        </div>

        <!-- Traveller List -->
        <div class="traveller-list-card" *ngIf="travellerList.length > 0">
          <div class="list-header">
            <h4 class="list-title">
              <i class="fas fa-list"></i>
              Passenger List
            </h4>
            <div class="list-count">
              {{ travellerList.length }} passenger(s) added
            </div>
          </div>

          <div class="traveller-list">
            <div class="traveller-item" 
                 *ngFor="let traveller of travellerList; let i = index"
                 [style.animation-delay.ms]="i * 100">
              <div class="traveller-avatar">
                <i class="fas" [class.fa-male]="getGenderLabel(traveller.gender) === 'Male'" 
                   [class.fa-female]="getGenderLabel(traveller.gender) === 'Female'"></i>
              </div>
              <div class="traveller-info">
                <h5 class="traveller-name">{{ traveller.firstName }} {{ traveller.lastName }}</h5>
                <div class="traveller-details">
                  <span class="detail-badge">
                    <i class="fas fa-chair"></i>
                    {{ getSeatClassLabel(traveller.seatClass) }}
                  </span>
                  <span class="detail-badge">
                    <i class="fas fa-calendar-alt"></i>
                    {{ traveller.age }} years
                  </span>
                  <span class="detail-badge">
                    <i class="fas fa-venus-mars"></i>
                    {{ getGenderLabel(traveller.gender) }}
                  </span>
                </div>
              </div>
              <div class="traveller-price">
                <span class="price-label">Price</span>
                <span class="price-amount">${{ traveller.price }}</span>
              </div>
              <div class="traveller-actions">
                <button class="action-btn edit-btn" (click)="editTraveller(i)" title="Edit">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn remove-btn" (click)="removeTraveller(i)" title="Remove">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="travellerList.length === 0">
          <div class="empty-icon">
            <i class="fas fa-user-plus"></i>
          </div>
          <h4 class="empty-title">No passengers added yet</h4>
          <p class="empty-text">Add passenger details to continue with your booking</p>
        </div>
      </div>

      <!-- Fare Details Sidebar -->
      <div class="fare-section">
        <div class="fare-card">
          <div class="fare-header">
            <h4 class="fare-title">
              <i class="fas fa-calculator"></i>
              Fare Breakdown
            </h4>
            <div class="fare-badge">
              <i class="fas fa-tag"></i>
              Best Price
            </div>
          </div>

          <div class="fare-details">
            <div class="fare-item">
              <div class="fare-label">
                <i class="fas fa-users"></i>
                <span>Base Fare ({{ travellerList.length }} passenger{{ travellerList.length !== 1 ? 's' : '' }})</span>
              </div>
              <div class="fare-amount">${{ calculateTotalFare() }}</div>
            </div>

            <div class="fare-item">
              <div class="fare-label">
                <i class="fas fa-shield-alt"></i>
                <span>Taxes & Fees</span>
              </div>
              <div class="fare-amount">$0</div>
            </div>

            <div class="fare-divider"></div>

            <div class="fare-total">
              <div class="total-label">
                <i class="fas fa-receipt"></i>
                <span>Total Amount</span>
              </div>
              <div class="total-amount">${{ calculateTotalFare() }}</div>
            </div>
          </div>

          <div class="fare-actions">
            <button 
              class="proceed-btn" 
              (click)="ProceedToBooking()"
              [disabled]="travellerList.length === 0 || isBooking">
              <span class="btn-content" *ngIf="!isBooking">
                <i class="fas fa-credit-card"></i>
                Proceed to Booking
              </span>
              <span class="btn-loading" *ngIf="isBooking">
                <div class="btn-spinner"></div>
                Processing...
              </span>
            </button>

            <div class="security-notice">
              <i class="fas fa-lock"></i>
              <span>Secure SSL encrypted payment</span>
            </div>
          </div>

          <!-- Price Guarantee -->
          <div class="price-guarantee">
            <div class="guarantee-icon">
              <i class="fas fa-medal"></i>
            </div>
            <div class="guarantee-content">
              <h5 class="guarantee-title">Price Guarantee</h5>
              <p class="guarantee-text">We guarantee the best price for your booking</p>
            </div>
          </div>
        </div>

        <!-- Additional Services -->
        <div class="services-card">
          <div class="services-header">
            <h4 class="services-title">
              <i class="fas fa-plus-circle"></i>
              Add-on Services
            </h4>
          </div>
          
          <div class="service-item">
            <div class="service-info">
              <i class="fas fa-suitcase"></i>
              <div class="service-details">
                <h5 class="service-name">Extra Baggage</h5>
                <p class="service-desc">Add 10kg extra baggage</p>
              </div>
            </div>
            <div class="service-price">+$25</div>
          </div>

          <div class="service-item">
            <div class="service-info">
              <i class="fas fa-utensils"></i>
              <div class="service-details">
                <h5 class="service-name">Meal Upgrade</h5>
                <p class="service-desc">Premium in-flight meal</p>
              </div>
            </div>
            <div class="service-price">+$15</div>
          </div>

          <div class="service-item">
            <div class="service-info">
              <i class="fas fa-chair"></i>
              <div class="service-details">
                <h5 class="service-name">Seat Selection</h5>
                <p class="service-desc">Choose your preferred seat</p>
              </div>
            </div>
            <div class="service-price">+$10</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Toast -->
  <div class="toast success-toast" [class.show]="showSuccessToast">
    <div class="toast-content">
      <i class="fas fa-check-circle"></i>
      <span>{{ toastMessage }}</span>
    </div>
    <button class="toast-close" (click)="hideToast()">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" *ngIf="isBooking">
    <div class="loading-content">
      <div class="loading-animation">
        <div class="plane-loading">
          <i class="fas fa-plane"></i>
        </div>
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
      <h3 class="loading-title">Processing your booking...</h3>
      <p class="loading-subtitle">Please wait while we confirm your reservation</p>
    </div>
  </div>
</div>
